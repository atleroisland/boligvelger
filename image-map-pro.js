!function($,window,document,undefined){"use strict";var fullscreenMap=undefined,fullscreenMapParent=undefined;$.imageMapProInitialized=function(t){},$.imageMapProEventHighlightedShape=function(t,i){},$.imageMapProEventUnhighlightedShape=function(t,i){},$.imageMapProEventClickedShape=function(t,i){},$.imageMapProEventOpenedTooltip=function(t,i){},$.imageMapProEventClosedTooltip=function(t,i){},$.imageMapProHighlightShape=function(t,i){var e=$('[data-shape-title="'+i+'"]').data("index"),s=instances[t].settings.spots[e];if(-1==instances[t].apiHighlightedShapes.indexOf(e)&&instances[t].apiHighlightedShapes.push(e),instances[t].connectedShapes[s.id])for(var n=0;n<instances[t].connectedShapes[s.id].length;n++){var o=instances[t].connectedShapes[s.id][n].index;-1==instances[t].apiHighlightedShapes.indexOf(o)&&instances[t].apiHighlightedShapes.push(o)}instances[t].highlightShape(e,!0)},$.imageMapProUnhighlightShape=function(t,i){var e=$('[data-shape-title="'+i+'"]').data("index"),s=instances[t].settings.spots[e];if(-1!=instances[t].apiHighlightedShapes.indexOf(e)){var n=instances[t].apiHighlightedShapes.indexOf(e);instances[t].apiHighlightedShapes.splice(n,1)}if(instances[t].connectedShapes[s.id])for(var o=0;o<instances[t].connectedShapes[s.id].length;o++){var a=instances[t].connectedShapes[s.id][o].index,h=instances[t].apiHighlightedShapes.indexOf(a);instances[t].apiHighlightedShapes.splice(h,1),instances[t].unhighlightShape(a)}instances[t].unhighlightShape(e)},$.imageMapProOpenTooltip=function(t,i){var e=$('[data-shape-title="'+i+'"]').data("index");instances[t].showTooltip(e),instances[t].updateTooltipPosition(e),-1==instances[t].apiOpenedTooltips.indexOf(e)&&instances[t].apiOpenedTooltips.push(e)},$.imageMapProHideTooltip=function(t,i){var e=$('[data-shape-title="'+i+'"]').data("index");if(-1!=instances[t].apiOpenedTooltips.indexOf(e)){var s=instances[t].apiOpenedTooltips.indexOf(e);instances[t].apiOpenedTooltips.splice(s,1)}instances[t].hideTooltip(e)},$.imageMapProReInitMap=function(t){instances[t].init()},$.imageMapProIsMobile=function(){return isMobile()};var pluginName="imageMapPro",default_settings=$.imageMapProEditorDefaults,default_spot_settings=$.imageMapProShapeDefaults,instances=new Array;function Plugin(t,i){this.element=t,this.settings=$.extend(!0,{},default_settings,i),this.root=$(t),this.wrap=undefined,this.zoomWrap=undefined,this.translateWrap=undefined,this.ui=undefined,this.uiNavigatorRoot=undefined,this.uiNavigatorWindow=undefined,this.uiNavigatorBackground=undefined,this.shapeContainer=undefined,this.shapeSvgContainer=undefined,this.fullscreenTooltipsContainer=undefined,this.visibleFullscreenTooltip=undefined,this.visibleFullscreenTooltipIndex=undefined,this.bodyOverflow=undefined,this.highlightedShapes=new Array,this.connectedShapes=new Array,this.openedTooltips=new Array,this.apiHighlightedShapes=new Array,this.apiOpenedTooltips=new Array,this.targetZoom=1,this.zoom=1,this.maxZoomLevel=8,this.zoomMultiplier=1.45,this.targetPanX=0,this.actualPanX=0,this.targetPanY=0,this.actualPanY=0,this.initialPanX=0,this.initialPanY=0,this.panDeltaY=0,this.ix=0,this.iy=0,this.lastX=0,this.lastY=0,this.pinchInitial=[{x:0,y:0},{x:0,y:0}],this.pinchInitialDistance=0,this.pinchInitialZoom=0,this.navigatorRatio=1,this.navigatorMarginX=0,this.navigatorMarginY=0,this.touch=!1,this.fullscreenTooltipVisible=!1,this.panning=!1,this.didPan=!1,this.panningOnNavigator=!1,this.pinching=!1,this.init()}function hexToRgb(t){var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null}function screenToImageMapSpace(t,i,e){return{x:Math.round(1e3*(t-e.offset().left))/1e3,y:Math.round(1e3*(i-e.offset().top))/1e3}}function isPointInsideRect(t,i,e,s,n,o){return t>=e&&t<=e+n&&i>=s&&i<=s+o}function isPointInsidePolygon(t,i,e){for(var s=!1,n=0,o=e.length-1;n<e.length;o=n++){var a=e[n][0],h=e[n][1],l=e[o][0],r=e[o][1];h>i!=r>i&&t<(l-a)*(i-h)/(r-h)+a&&(s=!s)}return s}function isPointInsideEllipse(t,i,e,s,n,o){return(t-e)*(t-e)/(n*n)+(i-s)*(i-s)/(o*o)<=1}function fitRectToScreen(t,i,e,s){return t<0&&(t=0),i<0&&(i=0),t>$(document).width()-e&&(t=$(document).width()-e),i>$(document).height()-s&&(i=$(document).height()-s),{x:t,y:i}}function shuffle(t){for(var i,e,s=t.length;0!==s;)e=Math.floor(Math.random()*s),i=t[s-=1],t[s]=t[e],t[e]=i;return t}function isMobile(){return!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function lerp(t,i,e){return t*(1-e)+i*e}$.extend(Plugin.prototype,{init:function(){var t=this;t.parseSettings(),instances[this.settings.general.name]=this,this.id=100*Math.random();for(var i=0;i<t.settings.spots.length;i++){var e=t.settings.spots[i],s=$.extend(!0,{},default_spot_settings);e=$.extend(!0,s,e),t.settings.spots[i]=$.extend(!0,{},e),t.settings.spots[i].title&&0!=t.settings.spots[i].title.length||(t.settings.spots[i].title=t.settings.spots[i].id),""!=e.connected_to&&(this.connectedShapes[e.connected_to]||(this.connectedShapes[e.connected_to]=new Array),this.connectedShapes[e.connected_to].push({id:e.id,index:i}))}var n=new Image;n.src=t.settings.image.url,t.loadImage(n,function(){},function(){var i="";i+='<div class="imp-wrap">',i+='   <div class="imp-ui" data-image-map-pro-ui-id="'+t.settings.id+'">',1==parseInt(t.settings.zooming.enable_zooming,10)&&1==parseInt(t.settings.zooming.enable_navigator,10)&&(i+='       <div class="imp-ui-navigator-root">',i+='         <div class="imp-ui-navigator-background"></div>',i+='         <div class="imp-ui-navigator-window"></div>',i+='         <img src="'+t.settings.image.url+'">',i+="      </div>"),1==parseInt(t.settings.zooming.enable_zooming,10)&&1==parseInt(t.settings.zooming.enable_zoom_buttons,10)&&(i+='       <div class="imp-ui-zoom-button imp-ui-zoom-button-zoom-in" style="color: '+t.settings.zooming.zoom_button_text_color+"; background: "+t.settings.zooming.zoom_button_background_color+';"><i class="fa fa-plus"></i></div>',i+='       <div class="imp-ui-zoom-button imp-ui-zoom-button-zoom-out" style="color: '+t.settings.zooming.zoom_button_text_color+"; background: "+t.settings.zooming.zoom_button_background_color+';"><i class="fa fa-minus"></i></div>'),i+="   </div>",i+='   <div class="imp-zoom-outer-wrap">',i+='       <div class="imp-translate-wrap">',i+='           <div class="imp-zoom-wrap">',i+='               <img src="'+t.settings.image.url+'" class="imp-main-image">',i+="           </div>",i+="       </div>",i+="   </div>",i+="</div>",t.root.html(i),t.wrap=t.root.find(".imp-wrap"),t.zoomWrap=t.root.find(".imp-zoom-wrap"),t.translateWrap=t.root.find(".imp-translate-wrap"),t.ui=t.wrap.find(".imp-ui"),t.root.addClass("imp-initialized"),t.root.attr("data-image-map-pro-id",t.settings.id),t.centerImageMap(),t.drawShapes(),t.addTooltips(),t.initFullscreen(),t.initZoom(),t.adjustSize(),t.initNavigator(),t.events(),t.APIEvents(),t.animateShapesLoop(),$.imageMapProInitialized(t.settings.general.name)}),$(window).off("resize."+this.settings.general.id+this.settings.runtime.is_fullscreen),$(window).on("resize."+this.settings.general.id+this.settings.runtime.is_fullscreen,function(){t.openedTooltips.length>0&&t.updateTooltipPosition(t.openedTooltips[t.openedTooltips.length-1]),t.resetZoomAndPan(),fullscreenMap&&fullscreenMap.adjustSize(),t.adjustNavigatorSize()})},parseSettings:function(){this.settings.general.image_url&&(this.settings.image.url=this.settings.general.image_url)},loadImage:function(t,i,e){t.complete&&t.naturalWidth!==undefined&&t.naturalHeight!==undefined?e():(i(),$(t).on("load",function(){$(t).off("load"),e()}))},centerImageMap:function(){1==parseInt(this.settings.general.center_image_map,10)&&this.wrap.css({margin:"0 auto"})},adjustSize:function(){var t=this;if(1==parseInt(t.settings.runtime.is_fullscreen,10)){var i=$(window).width()/$(window).height(),e=t.settings.general.width/t.settings.general.height;return e<i?(t.settings.general.width=$(window).height()*e,t.settings.general.height=$(window).height()):(t.settings.general.width=$(window).width(),t.settings.general.height=$(window).width()/e),void t.wrap.css({width:t.settings.general.width,height:t.settings.general.height})}if(1==parseInt(t.settings.general.responsive,10)){if(1==parseInt(t.settings.general.preserve_quality,10)){t.settings.general.naturalWidth||t.settings.general.width;t.wrap.css({"max-width":t.settings.general.naturalWidth})}}else t.wrap.css({width:t.settings.general.width,height:t.settings.general.height})},drawShapes:function(){for(var t=this,i=0;i<t.settings.spots.length;i++){if((h=t.settings.spots[i]).x=parseFloat(h.x),h.y=parseFloat(h.y),h.width=parseFloat(h.width),h.height=parseFloat(h.height),h.default_style.stroke_width=parseInt(h.default_style.stroke_width),h.mouseover_style.stroke_width=parseInt(h.mouseover_style.stroke_width),"poly"==h.type)for(var e=0;e<h.points.length;e++)h.points[e].x=parseFloat(h.points[e].x),h.points[e].y=parseFloat(h.points[e].y)}t.settings.general.width=parseInt(t.settings.general.width),t.settings.general.height=parseInt(t.settings.general.height),t.zoomWrap.prepend('<div class="imp-shape-container"></div>'),t.shapeContainer=t.wrap.find(".imp-shape-container");var s="",n=t.settings.general.width,o=t.settings.general.height;1==parseInt(t.settings.general.responsive,10)&&(n=t.settings.general.naturalWidth,o=t.settings.general.naturalHeight);var a='<svg class="hs-poly-svg" viewBox="0 0 '+n+" "+o+'" preserveAspectRatio="none">';for(i=0;i<t.settings.spots.length;i++){var h=t.settings.spots[i],l=this.calcStyles(h.default_style,i);if("spot"==h.type)if(1==parseInt(h.default_style.use_icon,10)){var r="imp-shape-spot";if(1==parseInt(h.default_style.icon_is_pin,10)&&(r+=" imp-shape-spot-pin"),s+='<div class="imp-shape '+r+'" id="'+h.id+'" data-shape-title="'+h.title+'" style="'+l+'" data-index='+i+">","library"==h.default_style.icon_type){var p="color: "+h.default_style.icon_fill+";";p+="line-height: "+h.height+"px;",s+='   <div class="imp-spot-fontawesome-icon" style="'+(p+="font-size: "+h.height+"px;")+'">',s+='       <i class="fa fa-'+h.default_style.icon_fontawesome_id+'"></i>',s+="   </div>"}if("custom"==h.default_style.icon_type&&h.default_style.icon_url.length>0&&(s+='<img src="'+h.default_style.icon_url+'" style="width: '+h.width+"px; height: "+h.height+'px">'),1==parseInt(h.default_style.icon_shadow,10)){var g="";g+="width: "+h.width+"px;",g+="height: "+h.height+"px;",s+='<div style="'+(g+="top: "+h.height/2+"px;")+'" class="imp-shape-icon-shadow"></div>'}s+="</div>"}else s+='<div class="imp-shape imp-shape-spot" id="'+h.id+'" data-shape-title="'+h.title+'" style="'+l+'" data-index='+i+"></div>";if("text"==h.type&&(s+='<div class="imp-shape imp-shape-text" id="'+h.id+'" data-shape-title="'+h.title+'" style="'+l+'" data-index='+i+">"+h.text.text+"</div>"),"rect"==h.type&&(s+='<div class="imp-shape imp-shape-rect" id="'+h.id+'" data-shape-title="'+h.title+'" style="'+l+'" data-index='+i+"></div>"),"oval"==h.type&&(s+='<div class="imp-shape imp-shape-oval" id="'+h.id+'" data-shape-title="'+h.title+'" style="'+l+'" data-index='+i+"></div>"),"poly"==h.type){a+='<polygon class="imp-shape imp-shape-poly" style="'+l+'" data-index='+i+' id="'+h.id+'" data-shape-title="'+h.title+'" points="';var d=n*(h.width/100),c=o*(h.height/100);h.vs=new Array;for(e=0;e<h.points.length;e++){var u=n*(h.x/100)+h.points[e].x/100*d,m=o*(h.y/100)+h.points[e].y/100*c;a+=u+","+m+" ",h.vs.push([u,m])}a+='"></polygon>'}}a+="</svg>",t.shapeContainer.html(s+a)},addTooltips:function(){var t=this;if("always"==t.settings.tooltips.fullscreen_tooltips||"mobile-only"==t.settings.tooltips.fullscreen_tooltips&&isMobile()){t.fullscreenTooltipsContainer||($('.imp-fullscreen-tooltips-container[data-image-map-id="'+t.settings.id+'"]').remove(),$("body").prepend('<div class="imp-fullscreen-tooltips-container" data-image-map-id="'+t.settings.id+'"></div>'),t.fullscreenTooltipsContainer=$('.imp-fullscreen-tooltips-container[data-image-map-id="'+t.settings.id+'"]'));for(var i="",e=0;e<t.settings.spots.length;e++){var s="",n=hexToRgb((o=t.settings.spots[e]).tooltip_style.background_color)||{r:0,b:0,g:0};if(s+="padding: "+o.tooltip_style.padding+"px;",s+="background: rgba("+n.r+", "+n.g+", "+n.b+", "+o.tooltip_style.background_opacity+");","none"==t.settings.tooltips.tooltip_animation&&(s+="opacity: 0;"),"fade"==t.settings.tooltips.tooltip_animation&&(s+="opacity: 0;",s+="transition-property: opacity;-moz-transition-property: opacity;-webkit-transition-property: opacity;"),"grow"==t.settings.tooltips.tooltip_animation&&(s+="transform: scale(0, 0);-moz-transform: scale(0, 0);-webkit-transform: scale(0, 0);",s+="transition-property: transform;-moz-transition-property: -moz-transform;-webkit-transition-property: -webkit-transform;",s+="transform-origin: 50% 50%;-moz-transform-origin: 50% 50%;-webkit-transform-origin: 50% 50%;"),i+='<div class="imp-fullscreen-tooltip" style="'+s+'" data-index="'+e+'">',i+='   <div class="imp-tooltip-close-button" data-index="'+e+'"><i class="fa fa-times" aria-hidden="true"></i></div>',"plain-text"==o.tooltip_content.content_type){s="";i+='<div class="imp-tooltip-plain-text" style="'+(s+="color: "+o.tooltip_content.plain_text_color+";")+'">'+o.tooltip_content.plain_text+"</div>"}else o.tooltip_content.squares_json?i+=$.squaresRendererRenderObject(o.tooltip_content.squares_json):i+=$.squaresRendererRenderObject(o.tooltip_content.squares_settings);i+="</div>"}t.fullscreenTooltipsContainer.html(i)}else{for(i="",e=0;e<t.settings.spots.length;e++){var o;s="",n=hexToRgb((o=t.settings.spots[e]).tooltip_style.background_color)||{r:0,b:0,g:0};if(s+="border-radius: "+o.tooltip_style.border_radius+"px;",s+="padding: "+o.tooltip_style.padding+"px;",s+="background: rgba("+n.r+", "+n.g+", "+n.b+", "+o.tooltip_style.background_opacity+");","none"==t.settings.tooltips.tooltip_animation&&(s+="opacity: 0;"),"fade"==t.settings.tooltips.tooltip_animation&&(s+="opacity: 0;",s+="transition-property: opacity;-moz-transition-property: opacity;-webkit-transition-property: opacity;"),"grow"==t.settings.tooltips.tooltip_animation&&(s+="transform: scale(0, 0);-moz-transform: scale(0, 0);-webkit-transform: scale(0, 0);",s+="transition-property: transform;-moz-transition-property: -moz-transform;-webkit-transition-property: -webkit-transform;","top"==o.tooltip_style.position&&(s+="transform-origin: 50% 100%;-moz-transform-origin: 50% 100%;-webkit-transform-origin: 50% 100%;"),"bottom"==o.tooltip_style.position&&(s+="transform-origin: 50% 0%;-moz-transform-origin: 50% 0%;-webkit-transform-origin: 50% 0%;"),"left"==o.tooltip_style.position&&(s+="transform-origin: 100% 50%;-moz-transform-origin: 100% 50%;-webkit-transform-origin: 100% 50%;"),"right"==o.tooltip_style.position&&(s+="transform-origin: 0% 50%;-moz-transform-origin: 0% 50%;-webkit-transform-origin: 0% 50%;")),i+='<div class="imp-tooltip" style="'+s+'" data-index="'+e+'">',"top"==o.tooltip_style.position&&(i+='   <div class="hs-arrow hs-arrow-bottom" style="border-top-color: rgba('+n.r+", "+n.g+", "+n.b+", "+o.tooltip_style.background_opacity+');"></div>'),"bottom"==o.tooltip_style.position&&(i+='   <div class="hs-arrow hs-arrow-top" style="border-bottom-color: rgba('+n.r+", "+n.g+", "+n.b+", "+o.tooltip_style.background_opacity+');"></div>'),"left"==o.tooltip_style.position&&(i+='   <div class="hs-arrow hs-arrow-right" style="border-left-color: rgba('+n.r+", "+n.g+", "+n.b+", "+o.tooltip_style.background_opacity+');"></div>'),"right"==o.tooltip_style.position&&(i+='   <div class="hs-arrow hs-arrow-left" style="border-right-color: rgba('+n.r+", "+n.g+", "+n.b+", "+o.tooltip_style.background_opacity+');"></div>'),"plain-text"==o.tooltip_content.content_type){s="";i+='<div class="imp-tooltip-plain-text" style="'+(s+="color: "+o.tooltip_content.plain_text_color+";")+'">'+o.tooltip_content.plain_text+"</div>"}else o.tooltip_content.squares_json?i+=$.squaresRendererRenderObject(o.tooltip_content.squares_json):i+=$.squaresRendererRenderObject(o.tooltip_content.squares_settings);i+="</div>"}t.wrap.prepend(i)}},initFullscreen:function(){if(1==parseInt(this.settings.fullscreen.enable_fullscreen_mode,10)){var t="";t+="background: "+this.settings.fullscreen.fullscreen_button_color+"; ",t+="color: "+this.settings.fullscreen.fullscreen_button_text_color+"; ";var i='<i class="fa fa-arrows-alt" aria-hidden="true"></i>';1==parseInt(this.settings.runtime.is_fullscreen,10)&&(i='<i class="fa fa-times" aria-hidden="true"></i>');var e="Go Fullscreen";1==parseInt(this.settings.runtime.is_fullscreen,10)&&(e="Close Fullscreen");var s="";"icon"==this.settings.fullscreen.fullscreen_button_type&&(s+=i),"text"==this.settings.fullscreen.fullscreen_button_type&&(s+=e),"icon_and_text"==this.settings.fullscreen.fullscreen_button_type&&(s+=i+" "+e);var n="";"icon"==this.settings.fullscreen.fullscreen_button_type&&(n+="imp-fullscreen-button-icon-only");var o="";o+='<div style="'+t+'" class="'+n+" imp-fullscreen-button imp-fullscreen-button-position-"+this.settings.fullscreen.fullscreen_button_position+'">',o+=s,o+="</div>",this.ui.append(o),1==parseInt(this.settings.runtime.is_fullscreen,10)&&($(window).scrollTop(0),fullscreenMap=this);var a=this.ui.find(".imp-fullscreen-button");1!=parseInt(this.settings.fullscreen.fullscreen_button_position,10)&&4!=parseInt(this.settings.fullscreen.fullscreen_button_position,10)||a.css({"margin-left":-a.outerWidth()/2}),1==parseInt(this.settings.fullscreen.start_in_fullscreen_mode,10)&&0==this.settings.runtime.is_fullscreen&&this.toggleFullscreen()}},initNavigator:function(){1==parseInt(this.settings.zooming.enable_zooming,10)&&1==parseInt(this.settings.zooming.enable_navigator,10)&&(this.uiNavigatorRoot=this.ui.find(".imp-ui-navigator-root"),this.uiNavigatorWindow=this.ui.find(".imp-ui-navigator-window"),this.uiNavigatorBackground=this.ui.find(".imp-ui-navigator-background"),this.adjustNavigatorSize())},initZoomButtons:function(){},initZoom:function(){1==parseInt(this.settings.zooming.enable_zooming,10)&&(1==parseInt(this.settings.zooming.limit_max_zoom_to_image_size,10)?this.maxZoomLevel=this.settings.general.naturalWidth/this.wrap.width():this.maxZoomLevel=this.settings.zooming.max_zoom)},adjustNavigatorSize:function(){if(0!=parseInt(this.settings.zooming.enable_zooming,10)&&0!=parseInt(this.settings.zooming.enable_navigator,10))if(1==parseInt(this.settings.runtime.is_fullscreen,10)){this.navigatorRatio=this.uiNavigatorRoot.width()/this.settings.general.width;var t=this.settings.general.naturalWidth/this.settings.general.naturalHeight,i=window.innerWidth/window.innerHeight,e=0,s=0,n=0,o=0;t<i?t<1?(n=150*t,e=(o=150)*i,s=o,this.navigatorMarginX=n/2-e/2,this.navigatorMarginY=0):(n=150,e=(o=150/t)*i,s=o,this.navigatorMarginX=n/2-e/2,this.navigatorMarginY=0):t<1?(o=150,e=n=150*t,s=n/i,this.navigatorMarginX=0,this.navigatorMarginY=o/2-s/2):(o=150/t,e=n=150,s=n/i,this.navigatorMarginX=0,this.navigatorMarginY=o/2-s/2),this.uiNavigatorWindow.css({width:e,height:s,transform:"translate("+this.navigatorMarginX+"px, "+this.navigatorMarginY+"px)"}),this.uiNavigatorBackground.css({left:-(e-n)/2,top:-(s-o)/2,width:e,height:s})}else this.navigatorRatio=this.uiNavigatorRoot.width()/this.wrap.width()},measureTooltipSize:function(t){if(!("always"==this.settings.tooltips.fullscreen_tooltips||"mobile"==this.settings.tooltips.fullscreen_tooltips&&isMobile())){var i=this.settings.spots[t],e=this.wrap.find('.imp-tooltip[data-index="'+t+'"]');0==parseInt(i.tooltip_style.auto_width,10)&&e.css({width:i.tooltip_style.width}),e.data("imp-measured-width",e.outerWidth()),e.data("imp-measured-height",e.outerHeight())}},animateShapesLoop:function(){if("none"!=this.settings.general.pageload_animation)for(var t=750/this.settings.spots.length,i=shuffle(this.settings.spots.slice()),e=0;e<i.length;e++)this.animateShape(i[e],t*e)},animateShape:function(t,i){var e=this,s=$("#"+t.id);setTimeout(function(){"fade"==e.settings.general.pageload_animation&&s.css({opacity:t.default_style.opacity}),"grow"==e.settings.general.pageload_animation&&s.css({transform:"scale(1, 1)","-moz-transform":"scale(1, 1)","-webkit-transform":"scale(1, 1)"})},i)},events:function(){var t=this;this.wrap.off("mousedown"),this.wrap.on("mousedown",function(i){t.touch||t.handleEventStart(i)}),this.wrap.off("mousemove"),this.wrap.on("mousemove",function(i){t.touch||t.handleEventMove(i)}),this.wrap.off("mouseup"),this.wrap.on("mouseup",function(i){t.touch||t.handleEventEnd(i)}),this.wrap.off("mousewheel"),this.wrap.on("mousewheel",function(i){if(!t.touch)return t.handleEventEnd(i),(1!=parseInt(t.settings.zooming.enable_zooming,10)||!(i.deltaY<0&&t.targetZoom>1||i.deltaY>0&&t.targetZoom<t.maxZoomLevel))&&void 0}),this.wrap.off("touchstart"),this.wrap.on("touchstart",function(i){return t.touch=!0,t.handleEventStart(i),!($(i.target).closest(".imp-ui").length>0)&&(!t.pinching&&void 0)}),this.wrap.off("touchmove"),this.wrap.on("touchmove",function(i){return t.handleEventMove(i),(!t.panning||0==t.panDeltaY)&&(!t.pinching&&void 0)}),this.wrap.off("touchend"),this.wrap.on("touchend",function(i){t.handleEventEnd(i)}),$(document).off("mousemove."+this.settings.id),$(document).on("mousemove."+this.settings.id,function(i){if(!t.touch&&(0!=$(i.target).closest(".imp-wrap").length&&0!=$(i.target).closest('[data-image-map-pro-id="'+t.settings.id+'"]').length||0!=$(i.target).closest(".imp-fullscreen-tooltips-container").length||("mouseover"==t.settings.tooltips.show_tooltips&&0==$(i.target).closest("[data-imp-open-tooltip-on-mouseover]").length&&0==$(i.target).closest("[data-imp-trigger-shape-on-mouseover]").length&&t.hideAllTooltips(),0==$(i.target).closest("[data-imp-highlight-shape-on-mouseover]").length&&0==$(i.target).closest("[data-imp-trigger-shape-on-mouseover]").length&&t.unhighlightAllShapes()),t.panning)){var e=t.getEventCoordinates(i);t.pan(e.x,e.y)}}),$(document).off("touchstart."+this.settings.id),$(document).on("touchstart."+this.settings.id,function(i){0!=$(i.target).closest(".imp-wrap").length&&0!=$(i.target).closest('[data-image-map-pro-id="'+t.settings.id+'"]').length||0!=$(i.target).closest(".imp-fullscreen-tooltips-container").length||("mouseover"==t.settings.tooltips.show_tooltips&&0==$(i.target).closest("[data-imp-open-tooltip-on-mouseover]").length&&0==$(i.target).closest("[data-imp-trigger-shape-on-mouseover]").length&&t.hideAllTooltips(),0==$(i.target).closest("[data-imp-highlight-shape-on-mouseover]").length&&0==$(i.target).closest("[data-imp-trigger-shape-on-mouseover]").length&&t.unhighlightAllShapes())}),$(document).off("mouseup."+this.settings.id),$(document).on("mouseup."+this.settings.id,function(i){t.touch||(0!=$(i.target).closest(".imp-wrap").length&&0!=$(i.target).closest('[data-image-map-pro-id="'+t.settings.id+'"]').length||0!=$(i.target).closest(".imp-fullscreen-tooltips-container").length||("click"==t.settings.tooltips.show_tooltips&&t.hideAllTooltips(),t.unhighlightAllShapes()),t.panning&&(t.panning=!1))}),$(document).off("touchend."+this.settings.id),$(document).on("touchend."+this.settings.id,function(i){0!=$(i.target).closest(".imp-wrap").length&&0!=$(i.target).closest('[data-image-map-pro-id="'+t.settings.id+'"]').length||0!=$(i.target).closest(".imp-fullscreen-tooltips-container").length||("click"==t.settings.tooltips.show_tooltips&&t.hideAllTooltips(),t.unhighlightAllShapes())}),$(document).off("click."+this.settings.id,".imp-tooltip-close-button"),$(document).on("click."+this.settings.id,".imp-tooltip-close-button",function(){t.hideAllTooltips()})},APIEvents:function(){var t=this;$(document).on("mouseover","[data-imp-highlight-shape-on-mouseover]",function(){var i=$(this).data("imp-highlight-shape-on-mouseover"),e=$(this).data("imp-image-map-name");if(e||(e=t.settings.general.name),e==t.settings.general.name){var s=$('[data-shape-title="'+i+'"]').data("index");t.highlightShape(s,!0)}}),$(document).on("mouseout","[data-imp-highlight-shape-on-mouseover]",function(){$(this).data("imp-highlight-shape-on-mouseover");var i=$(this).data("imp-image-map-name");i||(i=t.settings.general.name),i==t.settings.general.name&&t.unhighlightAllShapes()}),$(document).on("click","[data-imp-highlight-shape-on-click]",function(){var i=$(this).data("imp-highlight-shape-on-click"),e=$(this).data("imp-image-map-name");if(e||(e=t.settings.general.name),e==t.settings.general.name){var s=$('[data-shape-title="'+i+'"]').data("index"),n=t.settings.spots[s];if(t.highlightShape(s,!0),-1==instances[e].apiHighlightedShapes.indexOf(s)&&instances[e].apiHighlightedShapes.push(s),instances[e].connectedShapes[n.id])for(var o=0;o<instances[e].connectedShapes[n.id].length;o++){var a=instances[e].connectedShapes[n.id][o].index;-1==instances[e].apiHighlightedShapes.indexOf(a)&&instances[e].apiHighlightedShapes.push(a)}}}),$(document).on("mouseover","[data-imp-unhighlight-shape-on-mouseover]",function(){var i=$(this).data("imp-unhighlight-shape-on-mouseover"),e=$(this).data("imp-image-map-name");if(e||(e=t.settings.general.name),e==t.settings.general.name){var s=$('[data-shape-title="'+i+'"]').data("index"),n=t.settings.spots[s];if(-1!=instances[e].apiHighlightedShapes.indexOf(s)){var o=instances[e].apiHighlightedShapes.indexOf(s);instances[e].apiHighlightedShapes.splice(o,1)}if(instances[e].connectedShapes[n.id])for(var a=0;a<instances[e].connectedShapes[n.id].length;a++){var h=instances[e].connectedShapes[n.id][a].index,l=instances[e].apiHighlightedShapes.indexOf(h);instances[e].apiHighlightedShapes.splice(l,1),instances[e].unhighlightShape(h)}t.unhighlightShape(s)}}),$(document).on("click","[data-imp-unhighlight-shape-on-click]",function(){var i=$(this).data("imp-unhighlight-shape-on-click"),e=$(this).data("imp-image-map-name");if(e||(e=t.settings.general.name),e==t.settings.general.name){var s=$('[data-shape-title="'+i+'"]').data("index"),n=t.settings.spots[s];if(-1!=instances[e].apiHighlightedShapes.indexOf(s)){var o=instances[e].apiHighlightedShapes.indexOf(s);instances[e].apiHighlightedShapes.splice(o,1)}if(instances[e].connectedShapes[n.id])for(var a=0;a<instances[e].connectedShapes[n.id].length;a++){var h=instances[e].connectedShapes[n.id][a].index,l=instances[e].apiHighlightedShapes.indexOf(h);instances[e].apiHighlightedShapes.splice(l,1),instances[e].unhighlightShape(h)}t.unhighlightShape(s)}}),$(document).on("mouseover","[data-imp-open-tooltip-on-mouseover]",function(){var i=$(this).data("imp-open-tooltip-on-mouseover"),e=$(this).data("imp-image-map-name");if(e||(e=t.settings.general.name),e==t.settings.general.name){var s=$('[data-shape-title="'+i+'"]').data("index");t.showTooltip(s),t.updateTooltipPosition(s)}}),$(document).on("mouseout","[data-imp-open-tooltip-on-mouseover]",function(){$(this).data("imp-open-tooltip-on-mouseover");var i=$(this).data("imp-image-map-name");i||(i=t.settings.general.name),i==t.settings.general.name&&t.hideAllTooltips()}),$(document).on("click","[data-imp-open-tooltip-on-click]",function(){var i=$(this).data("imp-open-tooltip-on-click"),e=$(this).data("imp-image-map-name");if(e||(e=t.settings.general.name),e==t.settings.general.name){var s=$('[data-shape-title="'+i+'"]').data("index");t.showTooltip(s),t.updateTooltipPosition(s),-1==instances[e].apiOpenedTooltips.indexOf(s)&&instances[e].apiOpenedTooltips.push(s)}}),$(document).on("mouseover","[data-imp-close-tooltip-on-mouseover]",function(){var i=$(this).data("imp-close-tooltip-on-mouseover"),e=$(this).data("imp-image-map-name");if(e||(e=t.settings.general.name),e==t.settings.general.name){var s=$('[data-shape-title="'+i+'"]').data("index");if(-1!=instances[e].apiOpenedTooltips.indexOf(s)){var n=instances[e].apiOpenedTooltips.indexOf(s);instances[e].apiOpenedTooltips.splice(n,1)}t.hideTooltip(s)}}),$(document).on("click","[data-imp-close-tooltip-on-click]",function(){var i=$(this).data("imp-close-tooltip-on-click"),e=$(this).data("imp-image-map-name");if(e||(e=t.settings.general.name),e==t.settings.general.name){var s=$('[data-shape-title="'+i+'"]').data("index");if(-1!=instances[e].apiOpenedTooltips.indexOf(s)){var n=instances[e].apiOpenedTooltips.indexOf(s);instances[e].apiOpenedTooltips.splice(n,1)}t.hideTooltip(s)}}),$(document).on("mouseover","[data-imp-trigger-shape-on-mouseover]",function(){var i=$(this).data("imp-trigger-shape-on-mouseover"),e=$(this).data("imp-image-map-name");if(e||(e=t.settings.general.name),e==t.settings.general.name){var s=$('[data-shape-title="'+i+'"]').data("index");t.highlightShape(s,!0),t.showTooltip(s),t.updateTooltipPosition(s)}}),$(document).on("mouseout","[data-imp-trigger-shape-on-mouseover]",function(){$(this).data("imp-trigger-shape-on-mouseover");var i=$(this).data("imp-image-map-name");i||(i=t.settings.general.name),i==t.settings.general.name&&(t.unhighlightAllShapes(),t.hideAllTooltips())}),$(document).on("click","[data-imp-trigger-shape-on-click]",function(){var i=$(this).data("imp-trigger-shape-on-click"),e=$(this).data("imp-image-map-name");if(e||(e=t.settings.general.name),e==t.settings.general.name){var s=$('[data-shape-title="'+i+'"]').data("index"),n=t.settings.spots[s];if(t.highlightShape(s,!0),t.showTooltip(s),t.updateTooltipPosition(s),-1==instances[e].apiOpenedTooltips.indexOf(s)&&instances[e].apiOpenedTooltips.push(s),-1==instances[e].apiHighlightedShapes.indexOf(s)&&instances[e].apiHighlightedShapes.push(s),instances[e].connectedShapes[n.id])for(var o=0;o<instances[e].connectedShapes[n.id].length;o++){var a=instances[e].connectedShapes[n.id][o].index;-1==instances[e].apiHighlightedShapes.indexOf(a)&&instances[e].apiHighlightedShapes.push(a)}}}),$(document).on("mouseover","[data-imp-untrigger-shape-on-mouseover]",function(){var i=$(this).data("imp-untrigger-shape-on-mouseover"),e=$(this).data("imp-image-map-name");if(e||(e=t.settings.general.name),e==t.settings.general.name){var s=$('[data-shape-title="'+i+'"]').data("index"),n=t.settings.spots[s];if(-1!=instances[e].apiHighlightedShapes.indexOf(s)){var o=instances[e].apiHighlightedShapes.indexOf(s);instances[e].apiHighlightedShapes.splice(o,1)}if(instances[e].connectedShapes[n.id])for(var a=0;a<instances[e].connectedShapes[n.id].length;a++){var h=instances[e].connectedShapes[n.id][a].index,l=instances[e].apiHighlightedShapes.indexOf(h);instances[e].apiHighlightedShapes.splice(l,1),instances[e].unhighlightShape(h)}if(t.unhighlightShape(s),-1!=instances[e].apiOpenedTooltips.indexOf(s)){o=instances[e].apiOpenedTooltips.indexOf(s);instances[e].apiOpenedTooltips.splice(o,1)}t.hideTooltip(s)}}),$(document).on("click","[data-imp-untrigger-shape-on-click]",function(){var i=$(this).data("imp-untrigger-shape-on-click"),e=$(this).data("imp-image-map-name");if(e||(e=t.settings.general.name),e==t.settings.general.name){var s=$('[data-shape-title="'+i+'"]').data("index"),n=t.settings.spots[s];if(-1!=instances[e].apiHighlightedShapes.indexOf(s)){var o=instances[e].apiHighlightedShapes.indexOf(s);instances[e].apiHighlightedShapes.splice(o,1)}if(instances[e].connectedShapes[n.id])for(var a=0;a<instances[e].connectedShapes[n.id].length;a++){var h=instances[e].connectedShapes[n.id][a].index,l=instances[e].apiHighlightedShapes.indexOf(h);instances[e].apiHighlightedShapes.splice(l,1),instances[e].unhighlightShape(h)}if(t.unhighlightShape(s),-1!=instances[e].apiOpenedTooltips.indexOf(s)){o=instances[e].apiOpenedTooltips.indexOf(s);instances[e].apiOpenedTooltips.splice(o,1)}t.hideTooltip(s)}})},disableEvents:function(){this.wrap.off("mousemove"),this.wrap.off("mouseup"),this.wrap.off("touchstart"),this.wrap.off("touchmove"),this.wrap.off("touchend"),$(document).off("mousemove."+this.settings.id),$(document).off("touchstart."+this.settings.id),$(document).off("click."+this.settings.id,".imp-tooltip-close-button"),$(document).off("click."+this.settings.id,".imp-fullscreen-button")},handleEventStart:function(t){var i=this.getEventCoordinates(t);if(1==parseInt(this.settings.zooming.enable_zooming,10)){if($(t.target).closest(".imp-ui-navigator-root").length>0)return this.ix=i.x,this.iy=i.y,void(this.panningOnNavigator=!0);if(t.originalEvent.touches&&t.originalEvent.touches.length>1)return this.pinchInitial[0]={x:t.originalEvent.touches[0].pageX,y:t.originalEvent.touches[0].pageY},this.pinchInitial[1]={x:t.originalEvent.touches[1].pageX,y:t.originalEvent.touches[1].pageY},this.initialPanX=this.actualPanX,this.initialPanY=this.actualPanY,this.ix=(t.originalEvent.touches[0].pageX+t.originalEvent.touches[1].pageX)/2,this.iy=(t.originalEvent.touches[0].pageY+t.originalEvent.touches[1].pageY)/2,this.lastX=this.ix,this.lastY=this.iy,this.pinchInitialDistance=Math.sqrt(Math.pow(this.pinchInitial[1].x-this.pinchInitial[0].x,2)+Math.pow(this.pinchInitial[1].y-this.pinchInitial[0].y,2)),this.pinchInitialZoom=this.zoom,void(this.pinching=!0);this.panning||0!=$(t.target).closest(".imp-ui").length||(this.ix=i.x,this.iy=i.y,this.initialPanX=this.actualPanX,this.initialPanY=this.actualPanY,this.panning=!0)}},handleEventMove:function(t){if(!this.fullscreenTooltipVisible){var i=this.getEventRelativeCoordinates(t),e=this.matchShapeToCoords(i);if(1==parseInt(this.settings.zooming.enable_zooming,10)){if(this.panningOnNavigator){var s=((o=this.getEventCoordinates(t)).x-this.uiNavigatorRoot.offset().left)/this.navigatorRatio*this.targetZoom,n=(o.y-this.uiNavigatorRoot.offset().top)/this.navigatorRatio*this.targetZoom;return void this.panTo(s,n)}if(this.pinching)return this.pinch(t),void(this.didPan=!0);if(this.panning){var o=this.getEventCoordinates(t);return this.pan(o.x,o.y),void(this.didPan=!0)}}this.isPointInsideVisibleTooltip(t)&&0==parseInt(this.settings.tooltips.sticky_tooltips,10)||(-1!=e&&(this.didPan||(this.isShapeHighlighted(e)||(this.unhighlightAllShapes(),"mouseover"==this.settings.tooltips.show_tooltips&&this.hideAllTooltips(),this.highlightShape(e,!0)),"mouseover"==this.settings.tooltips.show_tooltips&&1==parseInt(this.settings.tooltips.enable_tooltips,10)&&1==parseInt(this.settings.spots[e].tooltip_style.enable_tooltip,10)&&this.showTooltip(e),this.openedTooltips.length>0&&1==parseInt(this.settings.tooltips.sticky_tooltips,10)&&"mouseover"==this.settings.tooltips.show_tooltips&&this.updateTooltipPosition(this.openedTooltips[this.openedTooltips.length-1],t))),-1==e&&(this.unhighlightAllShapes(),"mouseover"==this.settings.tooltips.show_tooltips&&this.hideAllTooltips()))}},handleEventEnd:function(t){if(1==parseInt(this.settings.zooming.enable_zooming,10)){if("mousewheel"==t.type)return t.deltaY>0&&this.zoomIn(t),void(t.deltaY<0&&this.zoomOut(t));if(this.panningOnNavigator&&(this.panningOnNavigator=!1),$(t.target).closest(".imp-ui-navigator-root").length>0){var i=this.getEventCoordinates(t),e=(i.x-this.uiNavigatorRoot.offset().left)/this.navigatorRatio*this.targetZoom,s=(i.y-this.uiNavigatorRoot.offset().top)/this.navigatorRatio*this.targetZoom;return void this.panTo(e,s)}if($(t.target).closest(".imp-ui-zoom-button").length>0)return void($(t.target).closest(".imp-ui-zoom-button-zoom-in").length>0?this.zoomIn():this.zoomOut());this.panning&&(this.panning=!1),this.pinching&&(this.pinching=!1)}if($(t.target).closest(".imp-fullscreen-button").length>0&&this.toggleFullscreen(),0==$(t.target).closest(".imp-tooltip").length&&!this.fullscreenTooltipVisible){var n=this.getEventRelativeCoordinates(t),o=this.matchShapeToCoords(n);-1!=o&&(this.didPan||(this.isShapeHighlighted(o)||(this.unhighlightAllShapes(),"mouseover"==this.settings.tooltips.show_tooltips&&this.hideAllTooltips(),this.highlightShape(o,!0)),1==parseInt(this.settings.tooltips.enable_tooltips,10)&&1==parseInt(this.settings.spots[o].tooltip_style.enable_tooltip,10)&&this.showTooltip(o),this.openedTooltips.length>0&&1==parseInt(this.settings.tooltips.sticky_tooltips,10)&&"mouseover"==this.settings.tooltips.show_tooltips&&this.updateTooltipPosition(this.openedTooltips[this.openedTooltips.length-1],t)),this.performClickAction(o)),-1==o&&(this.hideAllTooltips(),this.didPan||this.unhighlightAllShapes()),t.originalEvent.touches&&0==t.originalEvent.touches.length&&(this.didPan=!1),t.originalEvent.touches||(this.didPan=!1)}},getEventRelativeCoordinates:function(t){var i,e;if("touchstart"==t.type||"touchmove"==t.type||"touchend"==t.type||"touchcancel"==t.type){var s=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0];i=s.pageX,e=s.pageY}else"mousedown"!=t.type&&"mouseup"!=t.type&&"mousemove"!=t.type&&"mouseover"!=t.type&&"mouseout"!=t.type&&"mouseenter"!=t.type&&"mouseleave"!=t.type||(i=t.pageX,e=t.pageY);return i-=this.zoomWrap.offset().left,e-=this.zoomWrap.offset().top,{x:i=i/(this.wrap.width()*this.zoom)*100,y:e=e/(this.wrap.height()*this.zoom)*100}},getEventCoordinates:function(t){var i,e;if("touchstart"==t.type||"touchmove"==t.type||"touchend"==t.type||"touchcancel"==t.type){var s=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0];i=s.pageX,e=s.pageY}else"mousedown"!=t.type&&"mouseup"!=t.type&&"mousemove"!=t.type&&"mouseover"!=t.type&&"mouseout"!=t.type&&"mouseenter"!=t.type&&"mouseleave"!=t.type||(i=t.pageX,e=t.pageY);return{x:i,y:e}},matchShapeToCoords:function(t){for(var i=this.settings.spots.length-1;i>=0;i--){var e=this.settings.spots[i];if("poly"==e.type){var s=t.x/100*this.zoomWrap.width(),n=t.y/100*this.zoomWrap.height();if(isPointInsidePolygon(s=s*this.settings.general.naturalWidth/this.zoomWrap.width(),n=n*this.settings.general.naturalHeight/this.zoomWrap.height(),e.vs))return i}if("spot"==e.type){var o=e.width<44?44:e.width,a=e.height<44?44:e.height;o/=this.zoom,a/=this.zoom;var s=t.x/100*this.wrap.width(),n=t.y/100*this.wrap.height(),h=e.x/100*this.wrap.width()-o/2,l=e.y/100*this.wrap.height()-a/2,r=o,p=a;if(1==parseInt(e.default_style.icon_is_pin,10)&&1==parseInt(e.default_style.use_icon,10)&&(l-=a/2,e.height<44&&(l+=e.height/2)),isPointInsideRect(s,n,h,l,r,p))return i}if("rect"==e.type&&isPointInsideRect(t.x,t.y,e.x,e.y,e.width,e.height))return i;if("oval"==e.type)if(isPointInsideEllipse(s=t.x,n=t.y,e.x+e.width/2,e.y+e.height/2,h=e.width/2,l=e.height/2))return i;e.type}return-1},isPointInsideVisibleTooltip:function(t){for(var i=0;i<this.openedTooltips.length;i++){var e=this.getEventCoordinates(t),s=this.wrap.find('.imp-tooltip[data-index="'+this.openedTooltips[i]+'"]'),n=this.openedTooltips[i];e.x=(e.x-this.wrap.offset().left)/this.wrap.width()*100,e.y=(e.y-this.wrap.offset().top)/this.wrap.height()*100;var o=0;o="spot"==this.settings.spots[n].type?this.settings.spots[n].tooltip_style.buffer:this.settings.spots[n].tooltip_style.buffer*this.zoom;var a=s.outerWidth(),h=s.outerHeight(),l=s.offset().left-this.wrap.offset().left,r=s.offset().top-this.wrap.offset().top;l=l/this.wrap.width()*100,r=r/this.wrap.height()*100,a=a/this.wrap.width()*100,h=h/this.wrap.height()*100;var p=[];if("left"==this.settings.spots[n].tooltip_style.position)p=[[l,r],[l+a,r],[l+a+(o=o/this.wrap.width()*100),r+h-h/3-h/3],[l+a+o,r+h-h/3],[l+a,r+h],[l,r+h]];if("right"==this.settings.spots[n].tooltip_style.position)p=[[l,r],[l+a,r],[l+a,r+h],[l,r+h],[l-(o=o/this.wrap.width()*100),r+h-h/3],[l-o,r+h-h/3-h/3]];if("top"==this.settings.spots[n].tooltip_style.position)p=[[l,r],[l+a,r],[l+a,r+h],[l+a-a/3,r+h+(o=o/this.wrap.height()*100)],[l+a-a/3-a/3,r+h+o],[l,r+h]];if("bottom"==this.settings.spots[n].tooltip_style.position)p=[[l,r],[l+a-a/3-a/3,r-(o=o/this.wrap.height()*100)],[l+a-a/3,r-o],[l+a,r],[l+a,r+h],[l,r+h]];return!!isPointInsidePolygon(e.x,e.y,p)}},getIndexOfShapeWithID:function(t){for(var i=0;i<this.settings.spots.length;i++)if(this.settings.spots[i].id==t)return i},calcStyles:function(t,i){var e=this.settings.spots[i],s="";if("spot"==e.type){s+="left: "+e.x+"%;",s+="top: "+e.y+"%;",s+="width: "+e.width+"px;",s+="height: "+e.height+"px;",s+="opacity: "+t.opacity+";",s+="transform: scale("+1/this.zoom+");";var n=-e.width/2,o=-e.height/2;if(0==parseInt(e.default_style.use_icon,10)){var a=hexToRgb(t.background_color)||{r:0,b:0,g:0},h=hexToRgb(t.border_color)||{r:0,b:0,g:0};s+="border-radius: "+t.border_radius+"px;",s+="background: rgba("+a.r+", "+a.g+", "+a.b+", "+t.background_opacity+");",s+="border-width: "+t.border_width+"px;",s+="border-style: "+t.border_style+";",s+="border-color: rgba("+h.r+", "+h.g+", "+h.b+", "+t.border_opacity+");"}1==parseInt(e.default_style.use_icon,10)&&1==parseInt(e.default_style.icon_is_pin,10)&&(n=-e.height),s+="margin-left: "+o+"px;",s+="margin-top: "+n+"px;"}if("text"==e.type){var l=hexToRgb(e.text.text_color);s+="left: "+e.x+"%;",s+="top: "+e.y+"%;",s+="font-family: "+e.text.font_family+";",s+="font-size: "+e.text.font_size+"px;",s+="font-weight: "+e.text.font_weight+";",s+="color: rgba("+l.r+", "+l.g+", "+l.b+", "+e.text.text_opacity+");"}if("rect"==e.type||"oval"==e.type){var r=t.border_radius+"px";"oval"==e.type&&(r="50% 50%");a=hexToRgb(t.background_color)||{r:0,b:0,g:0},h=hexToRgb(t.border_color)||{r:0,b:0,g:0};s+="left: "+e.x+"%;",s+="top: "+e.y+"%;",s+="width: "+e.width+"%;",s+="height: "+e.height+"%;",s+="opacity: "+t.opacity+";",s+="background: rgba("+a.r+", "+a.g+", "+a.b+", "+t.background_opacity+");",s+="border-width: "+t.border_width+"px;",s+="border-style: "+t.border_style+";",s+="border-color: rgba("+h.r+", "+h.g+", "+h.b+", "+t.border_opacity+");",s+="border-radius: "+r+";"}if("poly"==e.type){var p=hexToRgb(t.fill)||{r:0,b:0,g:0},g=hexToRgb(t.stroke_color)||{r:0,b:0,g:0};s+="opacity: "+t.opacity+";",s+="fill: rgba("+p.r+", "+p.g+", "+p.b+", "+t.fill_opacity+");",s+="stroke: rgba("+g.r+", "+g.g+", "+g.b+", "+t.stroke_opacity+");",s+="stroke-width: "+t.stroke_width+"px;",s+="stroke-dasharray: "+t.stroke_dasharray+";",s+="stroke-linecap: "+t.stroke_linecap+";"}return s},applyStyles:function(t,i){var e=this.settings.spots[i],s=this.wrap.find("#"+e.id),n=this.calcStyles(t,i);s.attr("style",n),"spot"==e.type&&s.find("path").length>0&&s.find("path").attr("style","fill:"+t.icon_fill)},highlightShape:function(t,i){var e=this.settings.spots[t];if(i&&""!=e.connected_to){var s=this.getIndexOfShapeWithID(e.connected_to);this.highlightShape(s,!0)}else{if(this.connectedShapes[e.id])for(var n=0;n<this.connectedShapes[e.id].length;n++){s=this.connectedShapes[e.id][n].index;this.highlightShape(s,!1)}this.applyStyles(this.settings.spots[t].mouseover_style,t),$.imageMapProEventHighlightedShape(this.settings.general.name,e.title),-1==this.highlightedShapes.indexOf(t)&&this.highlightedShapes.push(t)}},unhighlightShape:function(t){var i=this.settings.spots[t];if(-1==this.apiHighlightedShapes.indexOf(t)){this.applyStyles(i.default_style,t),$.imageMapProEventUnhighlightedShape(this.settings.general.name,i.title);var e=this.highlightedShapes.indexOf(t);this.highlightedShapes.splice(e,1)}},unhighlightAllShapes:function(){for(var t=this.highlightedShapes.slice(0),i=0;i<t.length;i++)this.unhighlightShape(t[i])},isShapeHighlighted:function(t){for(var i=0;i<this.highlightedShapes.length;i++)if(this.highlightedShapes[i]==t)return!0;return!1},performClickAction:function(i){var s=this.settings.spots[i];"follow-link"==s.actions.click&&(0==$("#imp-temp-link").length&&$("body").append('<a href="" id="imp-temp-link" target="_blank"></a>'),$("#imp-temp-link").attr("href",s.actions.link),1==parseInt(s.actions.open_link_in_new_window,10)?$("#imp-temp-link").attr("target","_blank"):$("#imp-temp-link").removeAttr("target"),$("#imp-temp-link")[0].click()),"run-script"==s.actions.click&&eval(s.actions.script.replace("<br>","")),$.imageMapProEventClickedShape(this.settings.general.name,this.settings.spots[i].title)},showTooltip:function(t,i){var e=this.settings.spots[t];if(""==e.connected_to||1!=parseInt(e.use_connected_shape_tooltip,10)){if(-1==this.openedTooltips.indexOf(t)){if(this.openedTooltips.length>0&&this.hideAllTooltips(),-1==this.openedTooltips.indexOf(t)&&this.openedTooltips.push(t),"mobile-only"==this.settings.tooltips.fullscreen_tooltips&&isMobile()||"always"==this.settings.tooltips.fullscreen_tooltips){this.visibleFullscreenTooltip=$('.imp-fullscreen-tooltip[data-index="'+t+'"]'),this.visibleFullscreenTooltipIndex=t,this.fullscreenTooltipsContainer.show(),this.visibleFullscreenTooltip.show();var s=this;setTimeout(function(){s.visibleFullscreenTooltip.addClass("imp-tooltip-visible")},20),this.fullscreenTooltipVisible=!0,this.bodyOverflow=$("body").css("overflow"),$("body").css({overflow:"hidden"})}else{var n=this.wrap.find('.imp-tooltip[data-index="'+t+'"]');n.show(),setTimeout(function(){n.addClass("imp-tooltip-visible")},1),this.measureTooltipSize(t),this.updateTooltipPosition(t,i)}$.imageMapProEventOpenedTooltip(this.settings.general.name,this.settings.spots[t].title)}}else{var o=this.getIndexOfShapeWithID(e.connected_to);this.showTooltip(o)}},hideTooltip:function(t){if(-1==this.apiOpenedTooltips.indexOf(t)){var i=this.openedTooltips.indexOf(t);if(this.openedTooltips.splice(i,1),"mobile-only"==this.settings.tooltips.fullscreen_tooltips&&isMobile()||"always"==this.settings.tooltips.fullscreen_tooltips){var e=this;(s=this.fullscreenTooltipsContainer.find('.imp-fullscreen-tooltip[data-index="'+t+'"]')).removeClass("imp-tooltip-visible"),setTimeout(function(){e.fullscreenTooltipsContainer.hide(),s.hide()},200),this.fullscreenTooltipVisible=!1,$("body").css({overflow:this.bodyOverflow})}else{var s;(s=this.wrap.find('.imp-tooltip[data-index="'+t+'"]')).removeClass("imp-tooltip-visible"),setTimeout(function(){s.hide()},200)}$.imageMapProEventClosedTooltip(this.settings.general.name,this.settings.spots[t].title)}},hideAllTooltips:function(){for(var t=this.openedTooltips.slice(0),i=0;i<t.length;i++)this.hideTooltip(t[i])},updateTooltipPosition:function(t,i){if(!this.fullscreenTooltipVisible){var e,s,n,o,a,h,l,r;s=(e=this.wrap.find('.imp-tooltip[data-index="'+t+'"]')).data("imp-measured-width"),n=e.data("imp-measured-height"),r=this.settings.spots[t];var p,g,d=this.wrap.width(),c=this.wrap.height(),u=this.wrap.offset().left,m=this.wrap.offset().top,f=window.innerWidth,v=window.innerHeight;if(1==parseInt(this.settings.tooltips.sticky_tooltips,10)&&i){var w=this.getEventCoordinates(i);o=w.x-u,a=w.y-m,h=0,l=0}else h=r.width/100*d,l=r.height/100*c,h*=this.zoom,l*=this.zoom,o=Math.round(10*r.x)/10/100*d,a=Math.round(10*r.y)/10/100*c,o=o*this.zoom+this.actualPanX,a=a*this.zoom+this.actualPanY;"spot"==r.type&&(o-=r.width/2,a-=r.height/2,h=r.width,l=r.height),"spot"==r.type&&1==parseInt(r.default_style.icon_is_pin,10)&&"spot"==r.type&&1==parseInt(r.default_style.use_icon,10)&&(a-=l/2),1==parseInt(this.settings.runtime.is_fullscreen,10)?(o+u<0&&(h=h+o+u,o=-u),o+u+h>f&&(h+=f-(o+u+h)),a+m<0&&(l=l+a+m,a=-m),a+m+l>v&&(l+=v-(a+m+l))):(o<0&&(h+=o,o=0),o+h>d&&(h=d-o),a<0&&(l+=a,a=0),a+l>c&&(l=c-a)),"left"==r.tooltip_style.position&&(p=o-s-20,g=a+l/2-n/2),"right"==r.tooltip_style.position&&(p=o+h+20,g=a+l/2-n/2),"top"==r.tooltip_style.position&&(p=o+h/2-s/2,g=a-n-20),"bottom"==r.tooltip_style.position&&(p=o+h/2-s/2,g=a+l+20);var y={x:p,y:g};1==parseInt(this.settings.tooltips.constrain_tooltips,10)&&((y=fitRectToScreen(p+u,g+m,s,n)).x-=u,y.y-=m),1==parseInt(this.settings.runtime.is_fullscreen,10)&&(y.x+=u,y.y+=m),e.css({left:y.x,top:y.y})}},toggleFullscreen:function(){if(0==parseInt(this.settings.runtime.is_fullscreen,10)){$("body").addClass("imp-fullscreen-mode");var t=$.extend(!0,{},this.settings);t.runtime.is_fullscreen=1,t.id="999999",t.general.responsive=0;var i="";i+="background: "+this.settings.fullscreen.fullscreen_background,$("body").append('<div id="imp-fullscreen-wrap" style="'+i+'"><div id="image-map-pro-'+t.id+'"></div></div>'),$("#image-map-pro-"+t.id).imageMapPro(t),this.disableEvents(),fullscreenMapParent=this}else $("body").removeClass("imp-fullscreen-mode"),$("#imp-fullscreen-wrap").remove(),this.disableEvents(),fullscreenMapParent.events()},resetZoomAndPan:function(){this.zoom=1,this.targetZoom=1,this.targetPanX=0,this.targetPanY=0,this.actualPanX=0,this.actualPanY=0,this.redraw()},zoomIn:function(t){if(this.targetZoom<this.maxZoomLevel){var i=this.zoom*this.zoomMultiplier,e=0,s=0,n=this.wrap.width(),o=this.wrap.height();t?(e=t.pageX,s=t.pageY):(e=this.wrap.offset().left+n/2,s=this.wrap.offset().top+o/2),this.applyZoom(i,e,s)}},zoomOut:function(t){if(this.targetZoom>1){var i=this.zoom/this.zoomMultiplier,e=0,s=0,n=this.wrap.width(),o=this.wrap.height();t?(e=t.pageX,s=t.pageY):(e=this.wrap.offset().left+n/2,s=this.wrap.offset().top+o/2),this.applyZoom(i,e,s)}},applyZoom:function(t,i,e){this.targetZoom=this.zoom,this.targetPanX=this.actualPanX,this.targetPanY=this.actualPanY,this.redraw(),t>this.maxZoomLevel&&(t=this.maxZoomLevel),t<1&&(t=1),this.targetZoom=t;var s=this.wrap.width(),n=this.wrap.height(),o=i-this.zoomWrap.offset().left,a=e-this.zoomWrap.offset().top,h=(s*this.targetZoom-s*this.zoom)/2,l=(n*this.targetZoom-n*this.zoom)/2,r=h*((s*this.zoom/2-o)/(s*this.zoom/2)),p=l*((n*this.zoom/2-a)/(n*this.zoom/2));this.targetPanX-=h,this.targetPanY-=l,this.targetPanX+=r,this.targetPanY+=p;for(var g=0;g<this.settings.spots.length;g++){var d=this.settings.spots[g];"spot"==d.type&&this.wrap.find("#"+d.id).css({transform:"scale("+1/this.targetZoom+")"})}this.hideAllTooltips(),this.redraw()},pan:function(t,i){this.actualPanX=this.initialPanX-(this.ix-t),this.actualPanY=this.initialPanY-(this.iy-i);var e=this.wrap.width(),s=this.wrap.height(),n=this.wrap.offset().left,o=this.wrap.offset().top,a=window.innerWidth,h=window.innerHeight;1==parseInt(this.settings.runtime.is_fullscreen,10)?(e*this.zoom>a?(this.actualPanX>-n&&(this.actualPanX=-n),this.actualPanX<a-e*this.targetZoom-n&&(this.actualPanX=a-e*this.targetZoom-n)):this.actualPanX=(e-e*this.targetZoom)/2,s*this.zoom>h?(this.actualPanY>-o&&(this.actualPanY=-o),this.actualPanY<h-s*this.targetZoom-o&&(this.actualPanY=h-s*this.targetZoom-o)):this.actualPanY=(s-s*this.targetZoom)/2):(this.actualPanX>0&&(this.actualPanX=0),this.actualPanY>0&&(this.actualPanY=0),this.actualPanX<e-e*this.targetZoom&&(this.actualPanX=e-e*this.targetZoom),this.actualPanY<s-s*this.targetZoom&&(this.actualPanY=s-s*this.targetZoom)),this.panDeltaY=Math.abs(this.actualPanY-this.targetPanY),this.targetPanX=this.actualPanX,this.targetPanY=this.actualPanY,this.hideAllTooltips(),this.redraw()},panTo:function(t,i){var e=-t+this.wrap.width()/2,s=-i+this.wrap.height()/2;this.panDeltaY=Math.abs(s-this.targetPanY),this.targetPanX=e,this.targetPanY=s,this.hideAllTooltips(),this.redraw()},pinch:function(t){var i=(t.originalEvent.touches[0].pageX+t.originalEvent.touches[1].pageX)/2,e=(t.originalEvent.touches[0].pageY+t.originalEvent.touches[1].pageY)/2;this.actualPanX+=i-this.lastX,this.actualPanY+=e-this.lastY;var s=this.wrap.width(),n=this.wrap.height(),o=this.wrap.offset().left,a=this.wrap.offset().top,h=window.innerWidth,l=window.innerHeight;1==parseInt(this.settings.runtime.is_fullscreen,10)?(s*this.zoom>h?(this.actualPanX>-o&&(this.actualPanX=-o),this.actualPanX<h-s*this.targetZoom-o&&(this.actualPanX=h-s*this.targetZoom-o)):this.actualPanX=(s-s*this.targetZoom)/2,n*this.zoom>l?(this.actualPanY>-a&&(this.actualPanY=-a),this.actualPanY<l-n*this.targetZoom-a&&(this.actualPanY=l-n*this.targetZoom-a)):this.actualPanY=(n-n*this.targetZoom)/2):(this.actualPanX>0&&(this.actualPanX=0),this.actualPanY>0&&(this.actualPanY=0),this.actualPanX<s-s*this.targetZoom&&(this.actualPanX=s-s*this.targetZoom),this.actualPanY<n-n*this.targetZoom&&(this.actualPanY=n-n*this.targetZoom)),this.lastX=i,this.lastY=e;var r=Math.sqrt(Math.pow(t.originalEvent.touches[1].pageX-t.originalEvent.touches[0].pageX,2)+Math.pow(t.originalEvent.touches[1].pageY-t.originalEvent.touches[0].pageY,2))/this.pinchInitialDistance;this.applyZoom(this.pinchInitialZoom*r,i,e)},redraw:function(){var t=this.wrap.width(),i=this.wrap.height();if(1==parseInt(this.settings.runtime.is_fullscreen,10)){var e=this.wrap.offset().left,s=this.wrap.offset().top,n=$(window).width(),o=$(window).height();t*this.zoom>n?(this.targetPanX>-e&&(this.targetPanX=-e),this.targetPanX<n-t*this.targetZoom-e&&(this.targetPanX=n-t*this.targetZoom-e)):this.targetPanX=(t-t*this.targetZoom)/2,i*this.zoom>o?(this.targetPanY>-s&&(this.targetPanY=-s),this.targetPanY<o-i*this.targetZoom-s&&(this.targetPanY=o-i*this.targetZoom-s)):this.targetPanY=(i-i*this.targetZoom)/2}else this.targetPanX>0&&(this.targetPanX=0),this.targetPanY>0&&(this.targetPanY=0),this.targetPanX<t-t*this.targetZoom&&(this.targetPanX=t-t*this.targetZoom),this.targetPanY<i-i*this.targetZoom&&(this.targetPanY=i-i*this.targetZoom);this.zoom=lerp(this.zoom,this.targetZoom,.1),this.actualPanX=lerp(this.actualPanX,this.targetPanX,.1),this.actualPanY=lerp(this.actualPanY,this.targetPanY,.1),Math.abs(this.zoom-this.targetZoom)<.001&&(this.zoom=this.targetZoom),Math.abs(this.actualPanX-this.targetPanX)<1&&(this.actualPanX=this.targetPanX),Math.abs(this.actualPanY-this.targetPanY)<1&&(this.actualPanY=this.targetPanY),this.zoomWrap.css({transform:"scale("+this.zoom+", "+this.zoom+")"}),this.translateWrap.css({transform:"translate("+this.actualPanX+"px, "+this.actualPanY+"px)"}),this.uiNavigatorWindow&&this.uiNavigatorWindow.css({transform:"scale("+1/this.zoom+", "+1/this.zoom+") translate("+(-this.actualPanX*this.navigatorRatio+this.navigatorMarginX)+"px, "+(-this.actualPanY*this.navigatorRatio+this.navigatorMarginY)+"px)"});var a=this;this.zoom==this.targetZoom&&this.actualPanX==this.targetPanX&&this.actualPanY==this.targetPanY||window.requestAnimationFrame(function(){a.redraw()})}}),$.fn[pluginName]=function(t){return this.each(function(){$.data(this,"plugin_"+pluginName,new Plugin(this,t))})}}(jQuery,window,document),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}(function(t){function i(i){var a=i||window.event,h=l.call(arguments,1),r=0,g=0,d=0,c=0,u=0,m=0;if((i=t.event.fix(a)).type="mousewheel","detail"in a&&(d=-1*a.detail),"wheelDelta"in a&&(d=a.wheelDelta),"wheelDeltaY"in a&&(d=a.wheelDeltaY),"wheelDeltaX"in a&&(g=-1*a.wheelDeltaX),"axis"in a&&a.axis===a.HORIZONTAL_AXIS&&(g=-1*d,d=0),r=0===d?g:d,"deltaY"in a&&(r=d=-1*a.deltaY),"deltaX"in a&&(g=a.deltaX,0===d&&(r=-1*g)),0!==d||0!==g){if(1===a.deltaMode){var f=t.data(this,"mousewheel-line-height");r*=f,d*=f,g*=f}else if(2===a.deltaMode){var v=t.data(this,"mousewheel-page-height");r*=v,d*=v,g*=v}if(c=Math.max(Math.abs(d),Math.abs(g)),(!o||o>c)&&(o=c,s(a,c)&&(o/=40)),s(a,c)&&(r/=40,g/=40,d/=40),r=Math[r>=1?"floor":"ceil"](r/o),g=Math[g>=1?"floor":"ceil"](g/o),d=Math[d>=1?"floor":"ceil"](d/o),p.settings.normalizeOffset&&this.getBoundingClientRect){var w=this.getBoundingClientRect();u=i.clientX-w.left,m=i.clientY-w.top}return i.deltaX=g,i.deltaY=d,i.deltaFactor=o,i.offsetX=u,i.offsetY=m,i.deltaMode=0,h.unshift(i,r,g,d),n&&clearTimeout(n),n=setTimeout(e,200),(t.event.dispatch||t.event.handle).apply(this,h)}}function e(){o=null}function s(t,i){return p.settings.adjustOldDeltas&&"mousewheel"===t.type&&i%120==0}var n,o,a=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],h="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(t.event.fixHooks)for(var r=a.length;r;)t.event.fixHooks[a[--r]]=t.event.mouseHooks;var p=t.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var e=h.length;e;)this.addEventListener(h[--e],i,!1);else this.onmousewheel=i;t.data(this,"mousewheel-line-height",p.getLineHeight(this)),t.data(this,"mousewheel-page-height",p.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var e=h.length;e;)this.removeEventListener(h[--e],i,!1);else this.onmousewheel=null;t.removeData(this,"mousewheel-line-height"),t.removeData(this,"mousewheel-page-height")},getLineHeight:function(i){var e=t(i),s=e["offsetParent"in t.fn?"offsetParent":"parent"]();return s.length||(s=t("body")),parseInt(s.css("fontSize"),10)||parseInt(e.css("fontSize"),10)||16},getPageHeight:function(i){return t(i).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})});